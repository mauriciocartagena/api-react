{"ast":null,"code":"var _jsxFileName = \"/Applications/XAMPP/xamppfiles/htdocs/api-react/src/components/Products/index.js\";\nimport React, { Component } from 'react';\nimport PubSub from 'pubsub-js';\nimport { Table, Button, Form, FormGroup, Label, Input, Alert } from 'reactstrap';\n\nclass FormProduct extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      model: {\n        id: 0,\n        description: '',\n        price: 0,\n        quantity: 0\n      }\n    };\n\n    this.setValues = (e, field) => {\n      const {\n        model\n      } = this.state;\n      model[field] = e.target.value;\n      this.setState({\n        model\n      });\n    };\n\n    this.create = () => {\n      this.setState({\n        model: {\n          id: 0,\n          description: '',\n          price: 0,\n          quantity: 0\n        }\n      });\n      this.props.productCreate(this.state.model);\n    };\n  }\n\n  componentWillMount() {\n    PubSub.subscribe('edit-product', (topic, product) => {\n      this.setState({\n        model: product\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(Form, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }, \"Descri\\xE7\\xE3o:\"), React.createElement(Input, {\n      id: \"description\",\n      type: \"text\",\n      value: this.state.model.description,\n      placeholder: \"Descri\\xE7\\xE3o do Produto...\",\n      onChange: e => this.setValues(e, 'description'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    })), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, \"Pre\\xE7o:\"), React.createElement(Input, {\n      id: \"price\",\n      type: \"text\",\n      value: this.state.model.price,\n      placeholder: \"R$ \",\n      onChange: e => this.setValues(e, 'price'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-md-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"quantity\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, \"Quantidade:\"), React.createElement(Input, {\n      id: \"quantity\",\n      type: \"text\",\n      value: this.state.model.quantity,\n      placeholder: \"Qtd. de produtos dispon\\xEDveis\",\n      onChange: e => this.setValues(e, 'quantity'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    })))), React.createElement(Button, {\n      color: \"primary\",\n      block: true,\n      onClick: this.create,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, \" Gravar \"));\n  }\n\n}\n\nclass ListProduct extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.delete = id => {\n      this.props.deleteProduct(id);\n    };\n\n    this.onEdit = product => {\n      PubSub.publish('edit-product', product);\n    };\n  }\n\n  render() {\n    const {\n      products\n    } = this.props;\n    return React.createElement(Table, {\n      className: \"table-bordered text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      className: \"thead-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, \"Descri\\xE7\\xE3o\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, \"Pre\\xE7o\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, \"Qtde.\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"Actions\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, products.map(product => React.createElement(\"tr\", {\n      key: product.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, product.description), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, product.price), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, product.quantity), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"info\",\n      size: \"sm\",\n      onClick: e => this.onEdit(product),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"Editar\"), React.createElement(Button, {\n      color: \"danger\",\n      size: \"sm\",\n      onClick: e => this.delete(product.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Deletar\"))))));\n  }\n\n}\n\nexport default class ProductBox extends Component {\n  constructor(...args) {\n    super(...args);\n    this.Url = 'http://localhost:9000/products';\n    this.state = {\n      products: [],\n      message: {\n        text: '',\n        alert: ''\n      }\n    };\n\n    this.save = product => {\n      let data = {\n        id: parseInt(product.id),\n        description: product.description,\n        price: parseFloat(product.price),\n        quantity: parseInt(product.quantity)\n      };\n      console.log(data);\n      const requestInfo = {\n        method: data.id !== 0 ? 'PUT' : 'POST',\n        body: JSON.stringify(data),\n        headers: new Headers({\n          'Content-type': 'application/json'\n        })\n      };\n\n      if (data.id === 0) {\n        // CREATE NEW PRODUCT\n        fetch(this.Url, requestInfo).then(response => response.json()).then(newProduct => {\n          let {\n            products\n          } = this.state;\n          products.push(newProduct);\n          this.setState({\n            products,\n            message: {\n              text: 'Novo produto adicionado com sucesso!',\n              alert: 'success'\n            }\n          });\n          this.timerMessage(3000);\n        }).catch(e => console.log(e));\n      } else {\n        // EDIT PRODUCT\n        fetch(`${this.Url}/${data.id}`, requestInfo).then(response => response.json()).then(updatedProduct => {\n          let {\n            products\n          } = this.state;\n          let position = products.findIndex(product => product.id === data.id);\n          products[position] = updatedProduct;\n          this.setState({\n            products,\n            message: {\n              text: 'Produto atualizado com sucesso!',\n              alert: 'info'\n            }\n          });\n          this.timerMessage(3000);\n        }).catch(e => console.log(e));\n      }\n    };\n\n    this.delete = id => {\n      fetch(`${this.Url}/${id}`, {\n        method: 'DELETE'\n      }).then(response => response.json()).then(rows => {\n        const products = this.state.products.filter(product => product.id !== id);\n        this.setState({\n          products,\n          message: {\n            text: 'Produto deletado com sucesso.',\n            alert: 'danger'\n          }\n        });\n        this.timerMessage(3000);\n      }).catch(e => console.log(e));\n    };\n\n    this.timerMessage = duration => {\n      setTimeout(() => {\n        this.setState({\n          message: {\n            text: '',\n            alert: ''\n          }\n        });\n      }, duration);\n    };\n  }\n\n  componentDidMount() {\n    fetch(this.Url).then(response => response.json()).then(products => this.setState({\n      products\n    })).catch(e => console.log(e));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, this.state.message.text !== '' ? React.createElement(Alert, {\n      color: this.state.message.alert,\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \" \", this.state.message.text, \" \") : '', React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-6 my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      className: \"font-weight-bold text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \" Cadastro de Produtos \"), React.createElement(FormProduct, {\n      productCreate: this.save,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-md-6 my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      className: \"font-weight-bold text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \" Lista de Produtos \"), React.createElement(ListProduct, {\n      products: this.state.products,\n      deleteProduct: this.delete,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }))));\n  }\n\n}","map":{"version":3,"sources":["/Applications/XAMPP/xamppfiles/htdocs/api-react/src/components/Products/index.js"],"names":["React","Component","PubSub","Table","Button","Form","FormGroup","Label","Input","Alert","FormProduct","state","model","id","description","price","quantity","setValues","e","field","target","value","setState","create","props","productCreate","componentWillMount","subscribe","topic","product","render","ListProduct","delete","deleteProduct","onEdit","publish","products","map","ProductBox","Url","message","text","alert","save","data","parseInt","parseFloat","console","log","requestInfo","method","body","JSON","stringify","headers","Headers","fetch","then","response","json","newProduct","push","timerMessage","catch","updatedProduct","position","findIndex","rows","filter","duration","setTimeout","componentDidMount"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PubSub from 'pubsub-js';\n\nimport {\n    Table,\n    Button,\n    Form,\n    FormGroup,\n    Label,\n    Input,\n    Alert\n} from 'reactstrap';\n\nclass FormProduct extends Component {\n\n    state = {\n        model: {\n            id: 0,\n            description: '',\n            price: 0,\n            quantity: 0\n        }\n    };\n\n    setValues = (e, field) => {\n        const { model } = this.state;\n        model[field] = e.target.value;\n        this.setState({ model });\n    }\n\n    create = () => {\n        this.setState({ model: { id: 0,  description: '', price: 0, quantity: 0 } })\n        this.props.productCreate(this.state.model);\n    }\n\n    componentWillMount() {\n        PubSub.subscribe('edit-product', (topic, product) => {\n            this.setState({ model: product });\n        });\n    }\n\n    render() {\n        return (\n            <Form>\n                <FormGroup>\n                    <Label for=\"description\">Descrição:</Label>\n                    <Input id=\"description\" type=\"text\" value={this.state.model.description} placeholder=\"Descrição do Produto...\"\n                           onChange={e => this.setValues(e, 'description') } />\n                </FormGroup>\n                <FormGroup>\n                    <div className=\"form-row\">\n                        <div className=\"col-md-6\">\n                            <Label for=\"price\">Preço:</Label>\n                            <Input id=\"price\" type=\"text\"  value={this.state.model.price} placeholder=\"R$ \"\n                                   onChange={e => this.setValues(e, 'price') } />\n                        </div>\n                        <div className=\"col-md-6\">\n                            <Label for=\"quantity\">Quantidade:</Label>\n                            <Input id=\"quantity\" type=\"text\" value={this.state.model.quantity} placeholder=\"Qtd. de produtos disponíveis\"\n                                   onChange={e => this.setValues(e, 'quantity') } />\n                        </div>\n                    </div>\n                </FormGroup>\n                <Button color=\"primary\" block onClick={this.create}> Gravar </Button>\n            </Form>\n        );\n    }\n}\n\nclass ListProduct extends Component {\n\n    delete = (id) => {\n        this.props.deleteProduct(id);\n    }\n\n    onEdit = (product) => {\n        PubSub.publish('edit-product', product);\n    }\n\n    render() {\n        const { products } = this.props;\n        return (\n            <Table className=\"table-bordered text-center\">\n                <thead className=\"thead-dark\">\n                <tr>\n                    <th>Descrição</th>\n                    <th>Preço</th>\n                    <th>Qtde.</th>\n                    <th>Actions</th>\n                </tr>\n                </thead>\n                <tbody>\n                {\n                    products.map(product => (\n                        <tr key={product.id}>\n                            <td>{product.description}</td>\n                            <td>{product.price}</td>\n                            <td>{product.quantity}</td>\n                            <td>\n                                <Button color=\"info\" size=\"sm\" onClick={e => this.onEdit(product)}>Editar</Button>\n                                <Button color=\"danger\" size=\"sm\" onClick={e => this.delete(product.id)}>Deletar</Button>\n                            </td>\n                        </tr>\n                    ))\n                }\n                </tbody>\n            </Table>\n        );\n    }\n}\n\nexport default class ProductBox extends Component {\n\n    Url = 'http://localhost:9000/products';\n\n    state = {\n        products: [],\n        message: {\n            text: '',\n            alert: ''\n        }\n    }\n\n    componentDidMount() {\n        fetch(this.Url)\n            .then(response => response.json())\n            .then(products => this.setState({ products }))\n            .catch(e => console.log(e));\n    }\n\n    save = (product) => {\n        let data = {\n            id: parseInt(product.id),\n            description: product.description,\n            price: parseFloat(product.price),\n            quantity: parseInt(product.quantity),\n        };\n        console.log(data);\n\n        const requestInfo = {\n            method: data.id !== 0? 'PUT': 'POST',\n            body: JSON.stringify(data),\n            headers: new Headers({\n                'Content-type': 'application/json'\n            })\n        };\n\n        if(data.id === 0) {\n            // CREATE NEW PRODUCT\n            fetch(this.Url, requestInfo)\n                .then(response => response.json())\n                .then(newProduct => {\n                    let { products } = this.state;\n                    products.push(newProduct);\n                    this.setState({ products, message: { text: 'Novo produto adicionado com sucesso!', alert: 'success' } });\n                    this.timerMessage(3000);\n                })\n                .catch(e => console.log(e));\n        } else {\n            // EDIT PRODUCT\n            fetch(`${this.Url}/${data.id}`, requestInfo)\n                .then(response => response.json())\n                .then(updatedProduct => {\n                    let { products } = this.state;\n                    let position = products.findIndex(product => product.id === data.id);\n                    products[position] = updatedProduct;\n                    this.setState({ products, message: { text: 'Produto atualizado com sucesso!', alert: 'info' } });\n                    this.timerMessage(3000);\n                })\n                .catch(e => console.log(e));\n        }\n    }\n\n    delete = (id) => {\n        fetch(`${this.Url}/${id}`, {method: 'DELETE'})\n            .then(response => response.json())\n            .then(rows => {\n                const products = this.state.products.filter(product => product.id !== id);\n                this.setState({ products,  message: { text: 'Produto deletado com sucesso.', alert: 'danger' } });\n                this.timerMessage(3000);\n            })\n            .catch(e => console.log(e));\n    }\n\n    timerMessage = (duration) => {\n        setTimeout(() => {\n            this.setState({ message: { text: '', alert: ''} });\n        }, duration);\n    }\n\n    render() {\n        return (\n            <div>\n                {\n                    this.state.message.text !== ''? (\n                        <Alert color={this.state.message.alert} className=\"text-center\"> {this.state.message.text} </Alert>\n                    ) : ''\n                }\n\n                <div className=\"row\">\n\n                    <div className=\"col-md-6 my-3\">\n                        <h2 className=\"font-weight-bold text-center\"> Cadastro de Produtos </h2>\n                        <FormProduct productCreate={this.save} />\n                    </div>\n                    <div className=\"col-md-6 my-3\">\n                        <h2 className=\"font-weight-bold text-center\"> Lista de Produtos </h2>\n                        <ListProduct products={this.state.products}  deleteProduct={this.delete} />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}